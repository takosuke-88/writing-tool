
Replitへの指示プロンプト
text
このアプリをVercelにデプロイする準備をしてください。
以下の仕様に従って、必要な設定ファイルと機能を追加してください。

---

## 【デプロイ要件】

### 1. Vercel デプロイ設定
- `vercel.json` を作成してください
- Node.js（Express）のサーバーをVercel Functionsとして動作させる
- ビルドコマンドとデプロイ設定を適切に記述

### 2. 認証機能（Basic認証）
以下の認証情報を設定してください：
- **ユーザー名**: `takoball`
- **パスワード**: `squidball789@`

**認証の仕様：**
- ログイン成功後、**30日間はログイン状態を保持**（Cookie/LocalStorageを使用）
- 毎回パスワードを求めない（セッション管理）
- ログアウトボタンも追加（必要に応じて再ログイン可能）

**実装方法：**
- ミドルウェアでBasic認証を実装
- または、フロントエンドでログインフォームを作成し、認証トークンをCookieに保存

### 3. SEO対策（noindex設定）
- すべてのページに `<meta name="robots" content="noindex, nofollow">` を追加
- 検索エンジンにインデックスされないようにする

### 4. データ永続化（記事履歴の保存）
**現在の問題：**
SQLiteはVercelのサーバーレス環境では再デプロイ時にリセットされます。

**解決策（以下のいずれかを実装してください）：**

#### A. Vercel Postgres（推奨・無料枠あり）
- Vercel公式のPostgreSQLデータベースを使用
- 再デプロイしてもデータが消えない
- 環境変数で接続情報を管理

#### B. Vercel KV（Redis）
- キー・バリュー型データベース
- 記事データをJSON形式で保存
- 無料枠あり

#### C. 外部データベース（Supabase / PlanetScale など）
- 無料の外部DBサービスと連携
- 接続情報を環境変数で管理

**優先順位：**
まずは **Vercel Postgres** での実装をお願いします。

---

## 【環境変数の設定】

Vercelにデプロイする際、以下の環境変数を設定します（コード内に直書きしないこと）：

CLAUDE_API_KEY=（ユーザーが後で設定）
AUTH_USERNAME=takoball
AUTH_PASSWORD=squidball789@
SESSION_SECRET=（ランダムな文字列を自動生成）
DATABASE_URL=（Vercel Postgresの接続URL）

text

---

## 【ファイル構成の追加・修正】

以下のファイルを作成または修正してください：

### 1. `vercel.json`
Vercelデプロイ用の設定ファイル

### 2. `middleware/auth.js`
Basic認証（またはセッション認証）の実装

### 3. `pages/_document.js` または `index.html`
noindexメタタグの追加

### 4. `api/db.js`
データベース接続とCRUD操作を管理

### 5. `README.md`
デプロイ手順を記載：
- Vercelアカウント作成
- GitHubリポジトリとの連携
- 環境変数の設定方法
- デプロイコマンド

---

## 【デプロイ後の動作確認項目】

- [ ] URLにアクセスすると、ログイン画面が表示される
- [ ] `takoball` / `squidball789@` でログイン成功
- [ ] ログイン後、30日間は再ログイン不要
- [ ] 記事生成・保存が正常に動作
- [ ] 記事履歴がデータベースに保存される
- [ ] 再デプロイ後も、過去の記事が残っている
- [ ] `<meta name="robots" content="noindex">` が全ページに設定されている
- [ ] Google検索でインデックスされない

---

## 【補足】

- Vercelの無料プランで動作する範囲で実装してください
- デプロイ後、ユーザーがVercelダッシュボードで環境変数を設定する手順をREADMEに明記
- エラーハンドリングを適切に実装（DB接続失敗時など）

よろしくお願いします！
