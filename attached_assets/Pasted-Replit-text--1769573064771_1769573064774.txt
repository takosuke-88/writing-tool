Replitへの指示プロンプト
text
【機能追加】システムプロンプト（執筆ルール）の設定と保存・切り替え機能

現在のライティングツールに以下の機能を追加してください。

---

## 【UIの追加要件】

### 1. 「執筆ルール設定」パネル（左サイドバーに追加）

現在のサイドバーに「過去の記事」と並んで、
新しいセクション「📋 執筆ルール」を追加してください。

**構成：**
- セレクトドロップダウン：「テンプレート選択」
  - デフォルト選択肢：
    1. 「SEO記事（基本）」
    2. 「占い鑑定文（共感重視）」
    3. 「ブログ（親しみやすい）」
    4. 「カスタム」
    5. 「新規作成」

- テキストエリア：「実行するシステムプロンプト」
  - 選択したテンプレートの内容を表示
  - 編集可能（ユーザーが手動カスタマイズ可能）
  - 高さ：300-400px

- ボタン群：
  - 「このルールで保存」ボタン（新規テンプレートとして保存）
  - 「上書き保存」ボタン（現在選択中のテンプレートを更新）
  - 「削除」ボタン（カスタムテンプレートを削除）
  - 「リセット」ボタン（デフォルトテンプレートに戻す）

---

## 【バックエンド実装】

### 2. データベーステーブルの追加

`system_prompts` テーブルを作成してください：

```sql
CREATE TABLE system_prompts (
  id TEXT PRIMARY KEY,
  name TEXT UNIQUE NOT NULL,
  prompt_text TEXT NOT NULL,
  category TEXT,  -- 'default' または 'custom'
  created_at DATETIME,
  updated_at DATETIME
);
3. API エンドポイントの追加
GET /api/system-prompts
全ての保存済みシステムプロンプトを取得
レスポンス：

json
{
  "prompts": [
    {
      "id": "seo-basic",
      "name": "SEO記事（基本）",
      "prompt_text": "...",
      "category": "default"
    }
  ]
}
POST /api/system-prompts
新しいシステムプロンプトを保存
リクエスト：

json
{
  "name": "カスタム占い",
  "prompt_text": "あなたは...",
  "category": "custom"
}
PUT /api/system-prompts/:id
既存のシステムプロンプトを上書き保存

DELETE /api/system-prompts/:id
カスタムテンプレートを削除

4. 記事生成時のプロンプト構成
POST /api/generate-article をこう修正してください：

javascript
// 現在のコード（修正前）
const response = await client.messages.create({
  model: "claude-sonnet-4-5-20250929",
  max_tokens: 2000,
  messages: [
    {"role": "user", "content": prompt}
  ]
});

// 修正後
const response = await client.messages.create({
  model: "claude-sonnet-4-5-20250929",
  max_tokens: 2000,
  system: selectedSystemPrompt,  // ← 選択されたシステムプロンプト
  messages: [
    {"role": "user", "content": userInput}
  ]
});
重要： system パラメータが、Claudeに対する「ルール帳」になります。

【デフォルトテンプレート（初期セット）】
以下の3つを system_prompts テーブルに自動挿入してください：

テンプレート1: SEO記事（基本）
text
あなたはSEOに精通したベテランライターです。

【ミッション】
ユーザーの入力（お題または下書き）をもとに、
検索意図を満たす高品質な記事を執筆してください。

【执筆スタイル】
・自然な日本語（〜だよ、〜だね）で親しみやすさを重視
・AIっぽさを消すため、適度に砕けた表現や筆者の感情を15%混ぜてください
・適度に改行を入れ、スマホで読みやすい構成に
・「だから重要なのは...」「実は...」のような転換表現を活用

【禁止事項】
・「〜を解き放つ」「〜をアンロックする」などの定型表現
・過度な専門用語（必要な場合は説明を加える）
・1段落が400文字を超えることは避ける

【必須要素】
・冒頭に問いかけを1つ入れる
・実体験または失敗談を1つ盛り込む
・結論は「〜するべき」ではなく「〜もあり」と選択肢を示す形で
テンプレート2: 占い鑑定文（共感重視）
text
あなたはベテラン占い師です。

【ミッション】
相談者の心に寄り添い、勇気と希望を与える鑑定文を作成してください。

【鑑定スタイル】
・相談者の感情を読み取り、共感を全面に出す
・具体的な行動提案を3つ以上含める
・「あなたの強みは...」と長所をまず伝える
・最後は「応援しています」といったポジティブなメッセージで締める

【禁止事項】
・「絶対」「必ず」といった断定口調
・不安や恐怖を煽る表現
・政治・宗教・医療に関するアドバイス

【必須要素】
・相談内容の要点を冒頭で反復（相談者を認識していることを示す）
・運勢だけでなく「心持ち」についてのアドバイス
・具体的な日時や行動（例：「金曜日の夕方に...」）
テンプレート3: ブログ（親しみやすい）
text
あなたは日常をリアルに発信するブロガーです。

【ミッション】
読者に「あ、この人わかってるな」と思わせるような、
カジュアルで温かみのあるブログ記事を書いてください。

【執筆スタイル】
・一人称「俺」「私」を活用（統一する）
・「先日...」「実は...」と日常会話的な始まり
・絵文字は控えめに（もし使うなら1記事1-2個まで）
・読者への問いかけを中盤と終盤に1回ずつ

【禁止事項】
・高尚な言葉遣い
・「~すべき」という上から目線のアドバイス
・自慢がましい表現

【必須要素】
・失敗談を冒頭で打ち明ける
・「こうしたらうまくいった」という小さな工夫を共有
・最後は「あなたはどう？」という開かれた終わり方
【UI/UX の詳細】
テンプレート選択時、自動的にテキストエリアに内容が表示される

ユーザーが編集中に「リセット」ボタンで元に戻せる

「このルールで保存」時、テンプレート名を入力するモーダルが出現

削除時は「本当に削除しますか？」という確認ダイアログを表示

【フロー例】
ユーザーが「占い鑑定文（共感重視）」を選択
→ システムプロンプトが表示される

内容を読んで、「〜も追加してほしい」と編集

「このルールで保存」を押す
→ 「カスタム占い」という名前で新規テンプレートとして保存

次の記事生成時に「カスタム占い」を選択して使用

記事が生成される（このシステムプロンプトがClaudeに送信される）

【優先度】
✅ UIパネルの実装（セレクト + テキストエリア + ボタン）

✅ データベーステーブルの作成

✅ API エンドポイントの実装

✅ system パラメータを記事生成APIに統合

⚡ デフォルトテンプレートの初期挿入

よろしくお願いします！

